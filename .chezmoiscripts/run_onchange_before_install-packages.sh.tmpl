#!/bin/bash

{{ $brews := list
  "ack"
  "aha"
  "asdf"
  "awscli"
  "azure-cli"
  "bat"
  "bat-extras"
  "bcrypt"
  "btop"
  "chrome-cli"
  "cmake"
  "cointop"
  "cowsay"
  "ctags"
  "direnv"
  "expect"
  "eza"
  "fd"
  "figlet"
  "fortune"
  "fzf"
  "gh"
  "ghostscript"
  "gimme-aws-creds"
  "git"
  "git-delta"
  "git-lfs"
  "git-quick-stats"
  "go"
  "graphviz"
  "grc"
  "htop"
  "jid"
  "jq"
  "k9s"
  "kubernetes-cli"
  "lazygit"
  "lolcat"
  "luajit"
  "macchina"
  "moreutils"
  "navi"
  "neovim"
  "node"
  "olets/tap/zsh-abbr"
  "pinentry-mac"
  "postgresql@14"
  "python"
  "qpdf"
  "rbenv"
  "ripgrep"
  "ruby"
  "serverless"
  "solidity"
  "svn"
  "the_silver_searcher"
  "tig"
  "tldr"
  "tmux"
  "tree"
  "tree-sitter"
  "typescript"
  "util-linux"
  "w3m"
  "wget"
  "xclip"
  "yarn"
  "yq"
  "zoxide"
  "zsh-completions"
-}}

{{ $casks := list
  "font-hack"
  "font-hack-nerd-font"
  "font-inconsolata"
  "font-profont-nerd-font"
  "font-roboto-mono"
  "font-roboto-mono-for-powerline"
  "font-source-code-pro"
  "font-source-code-pro-for-powerline"
  "font-terminus"
  "alacritty"
  "bruno"
  "captin"
  "diffmerge"
  "iterm2"
  "keka"
  "keycastr"
  "mysqlworkbench"
  "pgadmin4"
  "postman"
  "setapp"
  "shortcat"
  "spotify"
  "squirrel"
  "visual-studio-code"
-}}

{{ if .personal -}}
{{   $brews = concat $brews (list
        "ccache"
        "dtc"
        "gperf"
        "libmagic"
        "ninja"
        "qemu"
        "qmk/qmk/qmk") -}}
{{   $casks = concat $casks (list
        "qlcolorcode"
        "qlmarkdown"
        "qlprettypatch"
        "quicklook-csv"
        "quicklook-json"
        "scriptql"
        "evernote"
        "hammerspoon"
        "keyclu"
        "kicad"
        "openscad"
        "thonny"
        "transmission"
        "whatsapp") -}}
{{ end -}}

# TODO: "qmk-toolbox" install failed

set -eufo pipefail

echo "############################################################################"
echo "{{ if .personal -}}Personal{{ else }}Work{{ end }} Setup"
echo "############################################################################"

brew bundle --no-lock --file=/dev/stdin <<EOF
{{ range ($brews | sortAlpha | uniq) -}}
brew "{{ . }}"
{{ end -}}
{{ range ($casks | sortAlpha | uniq) -}}
cask "{{ . }}"
{{ end -}}
EOF

